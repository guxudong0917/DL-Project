# 迁移学习

## 一、为什么需要迁移学习

      从0训练一个神经网络往往需要大规模的数据，不然很容易学到噪声，在上次的CNN训练区分宠物中，训练效果就不会很好。迁移学习，就是利用在大数据集上预训练好的网络，那些网络会学习到一些通用特征，再加上特定的数据集训练，就可以迁移到目标任务。

## 二、预训练模型学到了什么

       一般来说，视觉识别网络的特征层在浅层会学到像边缘，颜色等特征，中层可能会是纹理，局部形状，高层是较为抽象的特征。

       我们可以理解为浅层特征高度通用，高层特征与任务相关。预训练模型经过ImageNet的大数据集训练，它对于浅层特征的提取是较为优良的，会比自己训练效果要好很多。

## 三、迁移学习的基本形式

1. 特征提取（Feature Extraction）

       先**冻结卷积特征提取器的权重**，使其不参与训练，只训练根据任务新建的分类器层。冻结权重可以通过将所有参数的`requires_grad`属性设置为`False`来实现。

 2.    微调（Fine-tuning）

      如果目标物体在视觉上与普通的 ImageNet 图像有较大差异，那预训练网络这种特征组合可能无法达到最佳效果。所以可以只冻结部分层，解冻高层特征层重新训练。注意需要先对分类器进行训练稳定其权重。

      采用较小的学习率。

## 四、训练策略

      使用较小的batch_size加速收敛，用较小的学习率。